//https://github.com/gozoro/jquery-ajaxform
(function(d){d.fn.createFormData=function(){if(void 0!==window.FormData){var a=new FormData;d.each(this.serializeArray(),function(c,b){a.append(b.name,b.value)});d.each(this.find("input[type='file']"),function(c,b){d.each(d(b)[0].files,function(c,f){a.append(b.name,f)})})}else a=void 0;return a};d.fn.submitAjax=function(a){return a?this.on("submitajax",a):this.submit()}})(jQuery);
$(document).ready(function(){var d=function(a,c){var b=$(c),d=b.data("element"),f=b.data("error-class"),g=b.data("error-element"),h=b.data("error-attr");f&&(d?a.find(d).removeClass(f):b.removeClass(f));h?g?a.find(g).removeAttr(h):b.removeAttr(h):g&&a.find(g).html("")};$("form").on("submit",function(a){var c=$(this),b=c.data("via");if(/^ajax$/i.test(b)){b=c.attr("action");if(c.find("input[type=file]").length)if(void 0!==window.FormData)a.preventDefault(),a=c.createFormData(),$.ajax({url:b,type:"POST",
data:a,processData:!1,contentType:!1,xhrFields:{withCredentials:!0},success:function(a,b,d){c.trigger("submitajax",[a,b,d])}});else{var e=$('<iframe name=ajaxformiframe id="ajaxformiframe" width="0" height="0" frameborder="0" style="border:none;visibility:hidden;display:none;"></iframe>');c.append(e).attr("target","ajaxformiframe");e.load(function(){var a=e.contents().find("body").text();try{var b=$.parseJSON(a);c.trigger("submitajax",[b,"success",null])}catch(h){c.trigger("submitajax",[a,"success",
null])}c.removeAttr("target");e.contents().find("body").html("");e.unbind("load");e.remove()})}else a.preventDefault(),a=c.serializeArray(),$.post(b,a,function(a,b,d){c.trigger("submitajax",[a,b,d])});c.submitAjax(function(a,b){if(b.errors)for(var d in b.errors){var e=c.find(":input[name="+d+"]"),f=b.errors[d],g=e.data("element"),l=e.data("error-class"),k=e.data("error-element"),m=e.data("error-attr");l&&(g?c.find(g).addClass(l):e.addClass(l));m?k?c.find(k).attr(m,f):e.attr(m,f):k&&c.find(k).html(f)}});
c.find(":input").change(function(){d(c,this)});c.on("reset",function(){c.find(":input").each(function(b,a){d(c,a)})})}})});
